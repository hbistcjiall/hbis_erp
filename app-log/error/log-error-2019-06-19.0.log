2019-06-19 08:13:47.555 ERROR 7844 --- [Druid-ConnectionPool-Destroy-1944240894] com.alibaba.druid.util.JdbcUtils         : close connection error

java.sql.SQLRecoverableException: IO 错误: Connection reset by peer: socket write error
	at oracle.jdbc.driver.T4CConnection.logoff(T4CConnection.java:504)
	at oracle.jdbc.driver.PhysicalConnection.close(PhysicalConnection.java:3754)
	at com.alibaba.druid.filter.FilterChainImpl.connection_close(FilterChainImpl.java:186)
	at com.alibaba.druid.filter.stat.StatFilter.connection_close(StatFilter.java:261)
	at com.alibaba.druid.filter.FilterChainImpl.connection_close(FilterChainImpl.java:181)
	at com.alibaba.druid.filter.FilterAdapter.connection_close(FilterAdapter.java:776)
	at com.alibaba.druid.filter.FilterChainImpl.connection_close(FilterChainImpl.java:181)
	at com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl.close(ConnectionProxyImpl.java:115)
	at com.alibaba.druid.util.JdbcUtils.close(JdbcUtils.java:73)
	at com.alibaba.druid.pool.DruidDataSource.shrink(DruidDataSource.java:2833)
	at com.alibaba.druid.pool.DruidDataSource$DestroyTask.run(DruidDataSource.java:2598)
	at com.alibaba.druid.pool.DruidDataSource$DestroyConnectionThread.run(DruidDataSource.java:2585)
Caused by: java.net.SocketException: Connection reset by peer: socket write error
	at java.net.SocketOutputStream.socketWrite0(Native Method)
	at java.net.SocketOutputStream.socketWrite(SocketOutputStream.java:109)
	at java.net.SocketOutputStream.write(SocketOutputStream.java:153)
	at oracle.net.ns.DataPacket.send(DataPacket.java:199)
	at oracle.net.ns.NetOutputStream.flush(NetOutputStream.java:211)
	at oracle.net.ns.NetInputStream.getNextPacket(NetInputStream.java:227)
	at oracle.net.ns.NetInputStream.read(NetInputStream.java:175)
	at oracle.net.ns.NetInputStream.read(NetInputStream.java:100)
	at oracle.net.ns.NetInputStream.read(NetInputStream.java:85)
	at oracle.jdbc.driver.T4CSocketInputStreamWrapper.readNextPacket(T4CSocketInputStreamWrapper.java:122)
	at oracle.jdbc.driver.T4CSocketInputStreamWrapper.read(T4CSocketInputStreamWrapper.java:78)
	at oracle.jdbc.driver.T4CMAREngine.unmarshalUB1(T4CMAREngine.java:1179)
	at oracle.jdbc.driver.T4CMAREngine.unmarshalSB1(T4CMAREngine.java:1155)
	at oracle.jdbc.driver.T4CTTIfun.receive(T4CTTIfun.java:279)
	at oracle.jdbc.driver.T4CTTIfun.doRPC(T4CTTIfun.java:186)
	at oracle.jdbc.driver.T4C7Ocommoncall.doOLOGOFF(T4C7Ocommoncall.java:61)
	at oracle.jdbc.driver.T4CConnection.logoff(T4CConnection.java:491)
	... 11 common frames omitted

2019-06-19 10:27:09.874 ERROR 10952 --- [restartedMain] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'constantFactory' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\core\common\constant\factory\ConstantFactory.class]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1270)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:846)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:863)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:546)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:142)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:775)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:316)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1260)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1248)
	at cn.hbis.erp.HbisApplication.main(HbisApplication.java:36)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:184)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1262)
	... 22 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1482)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:575)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:224)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveNamedBean(DefaultListableBeanFactory.java:1112)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:407)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:341)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:335)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1101)
	at cn.stylefeng.roses.core.util.SpringContextHolder.getBean(SpringContextHolder.java:50)
	at cn.hbis.erp.core.common.constant.factory.ConstantFactory.<init>(ConstantFactory.java:30)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:172)
	... 24 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:627)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1288)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1127)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:273)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1237)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1467)
	... 43 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:622)
	... 56 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:632)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:387)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:685)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:166)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$45a8ef4e.CGLIB$sqlSessionFactory$0(<generated>)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$45a8ef4e$$FastClassBySpringCGLIB$$f8c148e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$45a8ef4e.sqlSessionFactory(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 57 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:259)
	at org.apache.ibatis.parsing.XPathParser.<init>(XPathParser.java:125)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.<init>(XMLMapperBuilder.java:78)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:629)
	... 70 common frames omitted
Caused by: org.xml.sax.SAXParseException: 元素内容必须由格式正确的字符数据或标记组成。
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:203)
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:400)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:327)
	at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1438)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.startOfMarkup(XMLDocumentFragmentScannerImpl.java:2637)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2735)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:848)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:777)
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141)
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:243)
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:257)
	... 73 common frames omitted

2019-06-19 10:44:03.374 ERROR 7192 --- [restartedMain] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'constantFactory' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\core\common\constant\factory\ConstantFactory.class]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1270)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:846)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:863)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:546)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:142)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:775)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:316)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1260)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1248)
	at cn.hbis.erp.HbisApplication.main(HbisApplication.java:36)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:184)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1262)
	... 22 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1482)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:575)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:224)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveNamedBean(DefaultListableBeanFactory.java:1112)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:407)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:341)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:335)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1101)
	at cn.stylefeng.roses.core.util.SpringContextHolder.getBean(SpringContextHolder.java:50)
	at cn.hbis.erp.core.common.constant.factory.ConstantFactory.<init>(ConstantFactory.java:30)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:172)
	... 24 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:627)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1288)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1127)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:273)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1237)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1467)
	... 43 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:622)
	... 56 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:632)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:387)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:685)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:166)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$3538d97a.CGLIB$sqlSessionFactory$1(<generated>)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$3538d97a$$FastClassBySpringCGLIB$$592ade2a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$3538d97a.sqlSessionFactory(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 57 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:259)
	at org.apache.ibatis.parsing.XPathParser.<init>(XPathParser.java:125)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.<init>(XMLMapperBuilder.java:78)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:629)
	... 70 common frames omitted
Caused by: org.xml.sax.SAXParseException: 元素内容必须由格式正确的字符数据或标记组成。
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:203)
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:400)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:327)
	at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1438)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.startOfMarkup(XMLDocumentFragmentScannerImpl.java:2637)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2735)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:848)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:777)
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141)
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:243)
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:257)
	... 73 common frames omitted

2019-06-19 10:45:27.588 ERROR 8368 --- [restartedMain] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'constantFactory' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\core\common\constant\factory\ConstantFactory.class]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1270)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:846)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:863)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:546)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:142)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:775)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:316)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1260)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1248)
	at cn.hbis.erp.HbisApplication.main(HbisApplication.java:36)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:184)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1262)
	... 22 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1482)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:575)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:224)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveNamedBean(DefaultListableBeanFactory.java:1112)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:407)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:341)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:335)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1101)
	at cn.stylefeng.roses.core.util.SpringContextHolder.getBean(SpringContextHolder.java:50)
	at cn.hbis.erp.core.common.constant.factory.ConstantFactory.<init>(ConstantFactory.java:30)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:172)
	... 24 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:627)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1288)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1127)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:273)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1237)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1467)
	... 43 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:622)
	... 56 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:632)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:387)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:685)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:166)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$fefe59bf.CGLIB$sqlSessionFactory$0(<generated>)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$fefe59bf$$FastClassBySpringCGLIB$$4f9ddbea.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$fefe59bf.sqlSessionFactory(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 57 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:259)
	at org.apache.ibatis.parsing.XPathParser.<init>(XPathParser.java:125)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.<init>(XMLMapperBuilder.java:78)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:629)
	... 70 common frames omitted
Caused by: org.xml.sax.SAXParseException: 元素内容必须由格式正确的字符数据或标记组成。
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:203)
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:400)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:327)
	at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1438)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.startOfMarkup(XMLDocumentFragmentScannerImpl.java:2637)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2735)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:848)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:777)
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141)
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:243)
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:257)
	... 73 common frames omitted

2019-06-19 10:46:54.272 ERROR 5584 --- [restartedMain] o.s.boot.SpringApplication               : Application run failed

org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'constantFactory' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\core\common\constant\factory\ConstantFactory.class]: Instantiation of bean failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1270)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.preInstantiateSingletons(DefaultListableBeanFactory.java:846)
	at org.springframework.context.support.AbstractApplicationContext.finishBeanFactoryInitialization(AbstractApplicationContext.java:863)
	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:546)
	at org.springframework.boot.web.servlet.context.ServletWebServerApplicationContext.refresh(ServletWebServerApplicationContext.java:142)
	at org.springframework.boot.SpringApplication.refresh(SpringApplication.java:775)
	at org.springframework.boot.SpringApplication.refreshContext(SpringApplication.java:397)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:316)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1260)
	at org.springframework.boot.SpringApplication.run(SpringApplication.java:1248)
	at cn.hbis.erp.HbisApplication.main(HbisApplication.java:36)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.boot.devtools.restart.RestartLauncher.run(RestartLauncher.java:49)
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [cn.hbis.erp.core.common.constant.factory.ConstantFactory]: Constructor threw exception; nested exception is org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:184)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:87)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateBean(AbstractAutowireCapableBeanFactory.java:1262)
	... 22 common frames omitted
Caused by: org.springframework.beans.factory.UnsatisfiedDependencyException: Error creating bean with name 'roleMapper' defined in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\RoleMapper.class]: Unsatisfied dependency expressed through bean property 'sqlSessionFactory'; nested exception is org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1482)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.populateBean(AbstractAutowireCapableBeanFactory.java:1362)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:575)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:224)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveNamedBean(DefaultListableBeanFactory.java:1112)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveBean(DefaultListableBeanFactory.java:407)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:341)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.getBean(DefaultListableBeanFactory.java:335)
	at org.springframework.context.support.AbstractApplicationContext.getBean(AbstractApplicationContext.java:1101)
	at cn.stylefeng.roses.core.util.SpringContextHolder.getBean(SpringContextHolder.java:50)
	at cn.hbis.erp.core.common.constant.factory.ConstantFactory.<init>(ConstantFactory.java:30)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
	at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
	at org.springframework.beans.BeanUtils.instantiateClass(BeanUtils.java:172)
	... 24 common frames omitted
Caused by: org.springframework.beans.factory.BeanCreationException: Error creating bean with name 'sqlSessionFactory' defined in class path resource [com/baomidou/mybatisplus/autoconfigure/MybatisPlusAutoConfiguration.class]: Bean instantiation via factory method failed; nested exception is org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:627)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiateUsingFactoryMethod(ConstructorResolver.java:607)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.instantiateUsingFactoryMethod(AbstractAutowireCapableBeanFactory.java:1288)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBeanInstance(AbstractAutowireCapableBeanFactory.java:1127)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.doCreateBean(AbstractAutowireCapableBeanFactory.java:538)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.createBean(AbstractAutowireCapableBeanFactory.java:498)
	at org.springframework.beans.factory.support.AbstractBeanFactory.lambda$doGetBean$0(AbstractBeanFactory.java:320)
	at org.springframework.beans.factory.support.DefaultSingletonBeanRegistry.getSingleton(DefaultSingletonBeanRegistry.java:222)
	at org.springframework.beans.factory.support.AbstractBeanFactory.doGetBean(AbstractBeanFactory.java:318)
	at org.springframework.beans.factory.support.AbstractBeanFactory.getBean(AbstractBeanFactory.java:199)
	at org.springframework.beans.factory.config.DependencyDescriptor.resolveCandidate(DependencyDescriptor.java:273)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.doResolveDependency(DefaultListableBeanFactory.java:1237)
	at org.springframework.beans.factory.support.DefaultListableBeanFactory.resolveDependency(DefaultListableBeanFactory.java:1164)
	at org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory.autowireByType(AbstractAutowireCapableBeanFactory.java:1467)
	... 43 common frames omitted
Caused by: org.springframework.beans.BeanInstantiationException: Failed to instantiate [org.apache.ibatis.session.SqlSessionFactory]: Factory method 'sqlSessionFactory' threw exception; nested exception is org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:185)
	at org.springframework.beans.factory.support.ConstructorResolver.instantiate(ConstructorResolver.java:622)
	... 56 common frames omitted
Caused by: org.springframework.core.NestedIOException: Failed to parse mapping resource: 'file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]'; nested exception is org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:632)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.afterPropertiesSet(MybatisSqlSessionFactoryBean.java:387)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.getObject(MybatisSqlSessionFactoryBean.java:685)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration.sqlSessionFactory(MybatisPlusAutoConfiguration.java:166)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$68c84685.CGLIB$sqlSessionFactory$0(<generated>)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$68c84685$$FastClassBySpringCGLIB$$8153d73a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invokeSuper(MethodProxy.java:244)
	at org.springframework.context.annotation.ConfigurationClassEnhancer$BeanMethodInterceptor.intercept(ConfigurationClassEnhancer.java:363)
	at com.baomidou.mybatisplus.autoconfigure.MybatisPlusAutoConfiguration$$EnhancerBySpringCGLIB$$68c84685.sqlSessionFactory(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.beans.factory.support.SimpleInstantiationStrategy.instantiate(SimpleInstantiationStrategy.java:154)
	... 57 common frames omitted
Caused by: org.apache.ibatis.builder.BuilderException: Error creating document instance.  Cause: org.xml.sax.SAXParseException; lineNumber: 261; columnNumber: 65; 元素内容必须由格式正确的字符数据或标记组成。
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:259)
	at org.apache.ibatis.parsing.XPathParser.<init>(XPathParser.java:125)
	at org.apache.ibatis.builder.xml.XMLMapperBuilder.<init>(XMLMapperBuilder.java:78)
	at com.baomidou.mybatisplus.extension.spring.MybatisSqlSessionFactoryBean.buildSqlSessionFactory(MybatisSqlSessionFactoryBean.java:629)
	... 70 common frames omitted
Caused by: org.xml.sax.SAXParseException: 元素内容必须由格式正确的字符数据或标记组成。
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.createSAXParseException(ErrorHandlerWrapper.java:203)
	at com.sun.org.apache.xerces.internal.util.ErrorHandlerWrapper.fatalError(ErrorHandlerWrapper.java:177)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:400)
	at com.sun.org.apache.xerces.internal.impl.XMLErrorReporter.reportError(XMLErrorReporter.java:327)
	at com.sun.org.apache.xerces.internal.impl.XMLScanner.reportFatalError(XMLScanner.java:1438)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.startOfMarkup(XMLDocumentFragmentScannerImpl.java:2637)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDriver.next(XMLDocumentFragmentScannerImpl.java:2735)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentScannerImpl.next(XMLDocumentScannerImpl.java:606)
	at com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(XMLDocumentFragmentScannerImpl.java:510)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:848)
	at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(XML11Configuration.java:777)
	at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(XMLParser.java:141)
	at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:243)
	at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:339)
	at org.apache.ibatis.parsing.XPathParser.createDocument(XPathParser.java:257)
	... 73 common frames omitted

2019-06-19 11:06:54.833 ERROR 2572 --- [http-nio-8081-exec-9] c.h.erp.core.aop.GlobalExceptionHandler  : 运行时异常:

org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.PersistenceException: 
### Error querying database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10008
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.ScmSteelSettleMapper.getCxNamePzg
### The error occurred while executing a query
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10008
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:77)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.executeForMany(PageMapperMethod.java:173)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:86)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy127.getCxNamePzg(Unknown Source)
	at cn.hbis.erp.modular.system.service.ScmSteelSettleService.getCxNamePzg(ScmSteelSettleService.java:157)
	at cn.hbis.erp.modular.system.service.ScmSteelSettleService$$FastClassBySpringCGLIB$$b0370e9a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.service.ScmSteelSettleService$$EnhancerBySpringCGLIB$$4efa6ab7.getCxNamePzg(<generated>)
	at cn.hbis.erp.modular.system.controller.ScmSteelSettleController.getCxNamePzg(ScmSteelSettleController.java:261)
	at cn.hbis.erp.modular.system.controller.ScmSteelSettleController$$FastClassBySpringCGLIB$$68731f5e.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at cn.hbis.erp.core.interceptor.SessionHolderInterceptor.sessionKit(SessionHolderInterceptor.java:29)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.controller.ScmSteelSettleController$$EnhancerBySpringCGLIB$$44b02815.getCxNamePzg(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:189)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:908)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:660)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)
	at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)
	at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at cn.stylefeng.roses.core.xss.XssFilter.doFilter(XssFilter.java:31)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:791)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1417)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.ibatis.exceptions.PersistenceException: 
### Error querying database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10008
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.ScmSteelSettleMapper.getCxNamePzg
### The error occurred while executing a query
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10008
	at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:30)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:150)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 112 common frames omitted
Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10008
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:81)
	at org.mybatis.spring.transaction.SpringManagedTransaction.openConnection(SpringManagedTransaction.java:82)
	at org.mybatis.spring.transaction.SpringManagedTransaction.getConnection(SpringManagedTransaction.java:68)
	at org.apache.ibatis.executor.BaseExecutor.getConnection(BaseExecutor.java:338)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:84)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)
	... 118 common frames omitted
Caused by: com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10008
	at com.alibaba.druid.pool.DruidDataSource.getConnectionInternal(DruidDataSource.java:1536)
	at com.alibaba.druid.pool.DruidDataSource.getConnectionDirect(DruidDataSource.java:1272)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5007)
	at com.alibaba.druid.filter.stat.StatFilter.dataSource_getConnection(StatFilter.java:680)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.filter.FilterAdapter.dataSource_getConnection(FilterAdapter.java:2745)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1250)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1242)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:89)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)
	at com.sun.proxy.$Proxy98.getConnection(Unknown Source)
	at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:151)
	at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:115)
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:78)
	... 128 common frames omitted

2019-06-19 11:06:54.833 ERROR 2572 --- [http-nio-8081-exec-8] c.h.erp.core.aop.GlobalExceptionHandler  : 运行时异常:

org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.PersistenceException: 
### Error querying database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10006
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.ScmSteelSettleMapper.getxsjswc
### The error occurred while executing a query
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10006
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:77)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.executeForMany(PageMapperMethod.java:173)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:86)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy127.getxsjswc(Unknown Source)
	at cn.hbis.erp.modular.system.service.ScmSteelSettleService.getxsjswccx(ScmSteelSettleService.java:177)
	at cn.hbis.erp.modular.system.service.ScmSteelSettleService$$FastClassBySpringCGLIB$$b0370e9a.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.service.ScmSteelSettleService$$EnhancerBySpringCGLIB$$4efa6ab7.getxsjswccx(<generated>)
	at cn.hbis.erp.modular.system.controller.YxybController.getxsjswccx(YxybController.java:67)
	at cn.hbis.erp.modular.system.controller.YxybController$$FastClassBySpringCGLIB$$c43b9fad.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at cn.hbis.erp.core.interceptor.SessionHolderInterceptor.sessionKit(SessionHolderInterceptor.java:29)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.controller.YxybController$$EnhancerBySpringCGLIB$$c658d262.getxsjswccx(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:189)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)
	at org.springframework.web.servlet.FrameworkServlet.doPost(FrameworkServlet.java:908)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:660)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)
	at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)
	at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at cn.stylefeng.roses.core.xss.XssFilter.doFilter(XssFilter.java:31)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:791)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1417)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.ibatis.exceptions.PersistenceException: 
### Error querying database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10006
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\ScmSteelSettleMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.ScmSteelSettleMapper.getxsjswc
### The error occurred while executing a query
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10006
	at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:30)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:150)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 112 common frames omitted
Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10006
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:81)
	at org.mybatis.spring.transaction.SpringManagedTransaction.openConnection(SpringManagedTransaction.java:82)
	at org.mybatis.spring.transaction.SpringManagedTransaction.getConnection(SpringManagedTransaction.java:68)
	at org.apache.ibatis.executor.BaseExecutor.getConnection(BaseExecutor.java:338)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:84)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)
	... 118 common frames omitted
Caused by: com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 10006
	at com.alibaba.druid.pool.DruidDataSource.getConnectionInternal(DruidDataSource.java:1536)
	at com.alibaba.druid.pool.DruidDataSource.getConnectionDirect(DruidDataSource.java:1272)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5007)
	at com.alibaba.druid.filter.stat.StatFilter.dataSource_getConnection(StatFilter.java:680)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.filter.FilterAdapter.dataSource_getConnection(FilterAdapter.java:2745)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1250)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1242)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:89)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)
	at com.sun.proxy.$Proxy98.getConnection(Unknown Source)
	at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:151)
	at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:115)
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:78)
	... 128 common frames omitted

2019-06-19 11:07:04.845 ERROR 2572 --- [pool-1-thread-3] cn.hbis.erp.core.log.LogManager          : 创建异常日志异常!

org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.PersistenceException: 
### Error updating database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20039
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20039
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:77)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:278)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:68)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy128.insert(Unknown Source)
	at cn.hbis.erp.core.log.factory.LogTaskFactory$5.run(LogTaskFactory.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.ibatis.exceptions.PersistenceException: 
### Error updating database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20039
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20039
	at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:30)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:200)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:185)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 13 common frames omitted
Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20039
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:81)
	at org.mybatis.spring.transaction.SpringManagedTransaction.openConnection(SpringManagedTransaction.java:82)
	at org.mybatis.spring.transaction.SpringManagedTransaction.getConnection(SpringManagedTransaction.java:68)
	at org.apache.ibatis.executor.BaseExecutor.getConnection(BaseExecutor.java:338)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:84)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:49)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:198)
	... 19 common frames omitted
Caused by: com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20039
	at com.alibaba.druid.pool.DruidDataSource.getConnectionInternal(DruidDataSource.java:1536)
	at com.alibaba.druid.pool.DruidDataSource.getConnectionDirect(DruidDataSource.java:1272)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5007)
	at com.alibaba.druid.filter.stat.StatFilter.dataSource_getConnection(StatFilter.java:680)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.filter.FilterAdapter.dataSource_getConnection(FilterAdapter.java:2745)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1250)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1242)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:89)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)
	at com.sun.proxy.$Proxy98.getConnection(Unknown Source)
	at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:151)
	at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:115)
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:78)
	... 27 common frames omitted

2019-06-19 11:07:04.850 ERROR 2572 --- [pool-1-thread-1] cn.hbis.erp.core.log.LogManager          : 创建异常日志异常!

org.mybatis.spring.MyBatisSystemException: nested exception is org.apache.ibatis.exceptions.PersistenceException: 
### Error updating database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20042
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20042
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:77)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.insert(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.insert(SqlSessionTemplate.java:278)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:68)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy128.insert(Unknown Source)
	at cn.hbis.erp.core.log.factory.LogTaskFactory$5.run(LogTaskFactory.java:95)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.ibatis.exceptions.PersistenceException: 
### Error updating database.  Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20042
### Cause: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20042
	at org.apache.ibatis.exceptions.ExceptionFactory.wrapException(ExceptionFactory.java:30)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:200)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.insert(DefaultSqlSession.java:185)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 13 common frames omitted
Caused by: org.springframework.jdbc.CannotGetJdbcConnectionException: Failed to obtain JDBC Connection; nested exception is com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20042
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:81)
	at org.mybatis.spring.transaction.SpringManagedTransaction.openConnection(SpringManagedTransaction.java:82)
	at org.mybatis.spring.transaction.SpringManagedTransaction.getConnection(SpringManagedTransaction.java:68)
	at org.apache.ibatis.executor.BaseExecutor.getConnection(BaseExecutor.java:338)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:84)
	at org.apache.ibatis.executor.SimpleExecutor.doUpdate(SimpleExecutor.java:49)
	at org.apache.ibatis.executor.BaseExecutor.update(BaseExecutor.java:117)
	at org.apache.ibatis.executor.CachingExecutor.update(CachingExecutor.java:76)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.update(DefaultSqlSession.java:198)
	... 19 common frames omitted
Caused by: com.alibaba.druid.pool.GetConnectionTimeoutException: wait millis 5000, active 0, maxActive 20, creating 1, createElapseMillis 20042
	at com.alibaba.druid.pool.DruidDataSource.getConnectionInternal(DruidDataSource.java:1536)
	at com.alibaba.druid.pool.DruidDataSource.getConnectionDirect(DruidDataSource.java:1272)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5007)
	at com.alibaba.druid.filter.stat.StatFilter.dataSource_getConnection(StatFilter.java:680)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.filter.FilterAdapter.dataSource_getConnection(FilterAdapter.java:2745)
	at com.alibaba.druid.filter.FilterChainImpl.dataSource_connect(FilterChainImpl.java:5003)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1250)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:1242)
	at com.alibaba.druid.pool.DruidDataSource.getConnection(DruidDataSource.java:89)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:343)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:198)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.JdkDynamicAopProxy.invoke(JdkDynamicAopProxy.java:212)
	at com.sun.proxy.$Proxy98.getConnection(Unknown Source)
	at org.springframework.jdbc.datasource.DataSourceUtils.fetchConnection(DataSourceUtils.java:151)
	at org.springframework.jdbc.datasource.DataSourceUtils.doGetConnection(DataSourceUtils.java:115)
	at org.springframework.jdbc.datasource.DataSourceUtils.getConnection(DataSourceUtils.java:78)
	... 27 common frames omitted

2019-06-19 11:07:05.814 ERROR 2572 --- [Druid-ConnectionPool-Create-967437894] com.alibaba.druid.pool.DruidDataSource   : create connection SQLException, url: jdbc:oracle:thin:@18.0.126.1:1521:coredb1, errorCode 20, state 61000

java.sql.SQLException: The Network Adapter could not establish the connection
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:412)
	at oracle.jdbc.driver.PhysicalConnection.<init>(PhysicalConnection.java:531)
	at oracle.jdbc.driver.T4CConnection.<init>(T4CConnection.java:221)
	at oracle.jdbc.driver.T4CDriverExtension.getConnection(T4CDriverExtension.java:32)
	at oracle.jdbc.driver.OracleDriver.connect(OracleDriver.java:503)
	at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:156)
	at com.alibaba.druid.filter.stat.StatFilter.connection_connect(StatFilter.java:218)
	at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:150)
	at com.alibaba.druid.filter.FilterAdapter.connection_connect(FilterAdapter.java:786)
	at com.alibaba.druid.filter.FilterChainImpl.connection_connect(FilterChainImpl.java:150)
	at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1572)
	at com.alibaba.druid.pool.DruidAbstractDataSource.createPhysicalConnection(DruidAbstractDataSource.java:1636)
	at com.alibaba.druid.pool.DruidDataSource$CreateConnectionThread.run(DruidDataSource.java:2505)
Caused by: oracle.net.ns.NetException: The Network Adapter could not establish the connection
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:359)
	at oracle.net.resolver.AddrResolution.resolveAndExecute(AddrResolution.java:422)
	at oracle.net.ns.NSProtocol.establishConnection(NSProtocol.java:672)
	at oracle.net.ns.NSProtocol.connect(NSProtocol.java:237)
	at oracle.jdbc.driver.T4CConnection.connect(T4CConnection.java:1042)
	at oracle.jdbc.driver.T4CConnection.logon(T4CConnection.java:301)
	... 12 common frames omitted
Caused by: java.net.ConnectException: Connection timed out: connect
	at java.net.DualStackPlainSocketImpl.waitForConnect(Native Method)
	at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:85)
	at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
	at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
	at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
	at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
	at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
	at java.net.Socket.connect(Socket.java:589)
	at oracle.net.nt.TcpNTAdapter.connect(TcpNTAdapter.java:141)
	at oracle.net.nt.ConnOption.connect(ConnOption.java:123)
	at oracle.net.nt.ConnStrategy.execute(ConnStrategy.java:337)
	... 17 common frames omitted

2019-06-19 17:52:09.726 ERROR 6192 --- [http-nio-8081-exec-6] c.h.erp.core.aop.GlobalExceptionHandler  : 运行时异常:

org.springframework.jdbc.UncategorizedSQLException: 
### Error querying database.  Cause: java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\AccountabilityUnitManageMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.AccountabilityUnitManageMapper.xsecxexcel
### The error occurred while executing a query
### SQL: select sum (fkimg ) from (         SELECT         company_id,         nvl(companyname,'-')companyname,         nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,         nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,         nvl(fkimg,0)fkimg,         nvl(kzwi6,0) kzwi6,         nvl(kzwi6*fkimg,0) money,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         nvl(DESTINATION_NAME,'-')DESTINATION_NAME,         nvl(CONTRACT_NO,0)CONTRACT_NO,         nvl(DJ_DATE,'-')DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         name,         nvl(VARIETY,'-')VARIETY,         nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'空') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         -- nvl(cxname,'-') name,         case when cxname is null then  '其他' end name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,          nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle          left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso          on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb          ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des          inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('9580','9727','9193')         ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                       and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)           UNION         SELECT         company_id ,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-') name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,          nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-')  VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         sso.DJ_DATE,         settle.VBELN,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )          where  detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')          and  settle.company_id in ('9196')) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and t.sale_body is not null          UNION         SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-')  name,         case when  company_id ='1932' then '中厚板'         when  company_id ='8110' then  '圆钢'         when  company_id ='8493' then '薄板' end  VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-')  PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-')  VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,         xsztdzb.sale_body，         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,          sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.SALE_PRICE,         svtp.VARIETY,         decode(settle.company_id,         1932,         '舞钢中厚板',         8110,         '石钢圆钢',         8493,         '衡板薄板') AS cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('8110','8493','1932')          ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and (         t.sggl = '分公司'         or t.sggl = '出口'         or t.sale_group = '销售部'         or  t.sale_group = '营销中心'         or  t.sale_group ='1000'         or  t.sale_group = '科技部'         or  t.sale_group = '舞钢国贸')           )         where 1=1                              ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')           )
### Cause: java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
; uncategorized SQLException; SQL state [null]; error code [0]; sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        ); nested exception is java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.executeForMany(PageMapperMethod.java:173)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:86)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy119.xsecxexcel(Unknown Source)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService.xsecx(AccountabilityUnitManageService.java:152)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$FastClassBySpringCGLIB$$49e914cd.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$EnhancerBySpringCGLIB$$4873c997.xsecx(<generated>)
	at cn.hbis.erp.modular.system.controller.ExportController.exportXSJSCx(ExportController.java:564)
	at cn.hbis.erp.modular.system.controller.ExportController$$FastClassBySpringCGLIB$$815f3b9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at cn.hbis.erp.core.interceptor.SessionHolderInterceptor.sessionKit(SessionHolderInterceptor.java:29)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.controller.ExportController$$EnhancerBySpringCGLIB$$4729644c.exportXSJSCx(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:189)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:897)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)
	at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)
	at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at cn.stylefeng.roses.core.xss.XssFilter.doFilter(XssFilter.java:31)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:791)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1417)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
	at com.alibaba.druid.wall.WallFilter.checkInternal(WallFilter.java:801)
	at com.alibaba.druid.wall.WallFilter.connection_prepareStatement(WallFilter.java:252)
	at com.alibaba.druid.filter.FilterChainImpl.connection_prepareStatement(FilterChainImpl.java:568)
	at com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl.prepareStatement(ConnectionProxyImpl.java:342)
	at com.alibaba.druid.pool.DruidPooledConnection.prepareStatement(DruidPooledConnection.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy168.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:87)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor.intercept(PaginationInterceptor.java:158)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)
	at com.sun.proxy.$Proxy167.prepare(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:85)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 112 common frames omitted

2019-06-19 17:58:13.694 ERROR 8516 --- [http-nio-8081-exec-9] c.h.erp.core.aop.GlobalExceptionHandler  : 运行时异常:

org.springframework.jdbc.UncategorizedSQLException: 
### Error querying database.  Cause: java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\AccountabilityUnitManageMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.AccountabilityUnitManageMapper.xsecxexcel
### The error occurred while executing a query
### SQL: select sum (fkimg ) from (         SELECT         company_id,         nvl(companyname,'-')companyname,         nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,         nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,         nvl(fkimg,0)fkimg,         nvl(kzwi6,0) kzwi6,         nvl(kzwi6*fkimg,0) money,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         nvl(DESTINATION_NAME,'-')DESTINATION_NAME,         nvl(CONTRACT_NO,0)CONTRACT_NO,         nvl(DJ_DATE,'-')DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         name,         nvl(VARIETY,'-')VARIETY,         nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'空') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         -- nvl(cxname,'-') name,         case when cxname is null then  '其他' end name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,          nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle          left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso          on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb          ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des          inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('9580','9727','9193')         ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                       and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)           UNION         SELECT         company_id ,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-') name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,          nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-')  VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         sso.DJ_DATE,         settle.VBELN,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )          where  detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')          and  settle.company_id in ('9196')) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and t.sale_body is not null          UNION         SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-')  name,         case when  company_id ='1932' then '中厚板'         when  company_id ='8110' then  '圆钢'         when  company_id ='8493' then '薄板' end  VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-')  PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-')  VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,         xsztdzb.sale_body，         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,          sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.SALE_PRICE,         svtp.VARIETY,         decode(settle.company_id,         1932,         '舞钢中厚板',         8110,         '石钢圆钢',         8493,         '衡板薄板') AS cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('8110','8493','1932')          ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and (         t.sggl = '分公司'         or t.sggl = '出口'         or t.sale_group = '销售部'         or  t.sale_group = '营销中心'         or  t.sale_group ='1000'         or  t.sale_group = '科技部'         or  t.sale_group = '舞钢国贸')           )         where 1=1                              ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')           )
### Cause: java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
; uncategorized SQLException; SQL state [null]; error code [0]; sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        ); nested exception is java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.executeForMany(PageMapperMethod.java:173)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:86)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy119.xsecxexcel(Unknown Source)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService.xsecx(AccountabilityUnitManageService.java:152)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$FastClassBySpringCGLIB$$49e914cd.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$EnhancerBySpringCGLIB$$483905c0.xsecx(<generated>)
	at cn.hbis.erp.modular.system.controller.ExportController.exportXSJSCx(ExportController.java:564)
	at cn.hbis.erp.modular.system.controller.ExportController$$FastClassBySpringCGLIB$$815f3b9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at cn.hbis.erp.core.interceptor.SessionHolderInterceptor.sessionKit(SessionHolderInterceptor.java:29)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.controller.ExportController$$EnhancerBySpringCGLIB$$f3f055ca.exportXSJSCx(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:189)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:897)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)
	at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)
	at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at cn.stylefeng.roses.core.xss.XssFilter.doFilter(XssFilter.java:31)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:791)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1417)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.sql.SQLException: sql injection violation, comment not allow : select sum (fkimg ) from (
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')


        )
	at com.alibaba.druid.wall.WallFilter.checkInternal(WallFilter.java:801)
	at com.alibaba.druid.wall.WallFilter.connection_prepareStatement(WallFilter.java:252)
	at com.alibaba.druid.filter.FilterChainImpl.connection_prepareStatement(FilterChainImpl.java:568)
	at com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl.prepareStatement(ConnectionProxyImpl.java:342)
	at com.alibaba.druid.pool.DruidPooledConnection.prepareStatement(DruidPooledConnection.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy168.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:87)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor.intercept(PaginationInterceptor.java:158)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)
	at com.sun.proxy.$Proxy167.prepare(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:85)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 112 common frames omitted

2019-06-19 18:04:45.779 ERROR 9868 --- [http-nio-8081-exec-8] c.h.erp.core.aop.GlobalExceptionHandler  : 运行时异常:

org.springframework.jdbc.UncategorizedSQLException: 
### Error querying database.  Cause: java.sql.SQLException: sql injection violation, comment not allow : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\AccountabilityUnitManageMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.AccountabilityUnitManageMapper.xsecxexcel
### The error occurred while executing a query
### SQL: SELECT         company_id,         nvl(companyname,'-')companyname,         nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,         nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,         nvl(fkimg,0)fkimg,         nvl(kzwi6,0) kzwi6,         nvl(kzwi6*fkimg,0) money,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         nvl(DESTINATION_NAME,'-')DESTINATION_NAME,         nvl(CONTRACT_NO,0)CONTRACT_NO,         nvl(DJ_DATE,'-')DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         name,         nvl(VARIETY,'-')VARIETY,         nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'空') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         -- nvl(cxname,'-') name,         case when cxname is null then  '其他' end name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,          nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle          left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso          on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb          ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des          inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('9580','9727','9193')         ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                       and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)           UNION         SELECT         company_id ,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-') name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,          nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-')  VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         sso.DJ_DATE,         settle.VBELN,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )          where  detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')          and  settle.company_id in ('9196')) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and t.sale_body is not null          UNION         SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-')  name,         case when  company_id ='1932' then '中厚板'         when  company_id ='8110' then  '圆钢'         when  company_id ='8493' then '薄板' end  VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-')  PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-')  VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,         xsztdzb.sale_body，         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,          sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.SALE_PRICE,         svtp.VARIETY,         decode(settle.company_id,         1932,         '舞钢中厚板',         8110,         '石钢圆钢',         8493,         '衡板薄板') AS cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('8110','8493','1932')          ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and (         t.sggl = '分公司'         or t.sggl = '出口'         or t.sale_group = '销售部'         or  t.sale_group = '营销中心'         or  t.sale_group ='1000'         or  t.sale_group = '科技部'         or  t.sale_group = '舞钢国贸')           )         where 1=1                              ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
### Cause: java.sql.SQLException: sql injection violation, comment not allow : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
; uncategorized SQLException; SQL state [null]; error code [0]; sql injection violation, comment not allow : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝'); nested exception is java.sql.SQLException: sql injection violation, comment not allow : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.executeForMany(PageMapperMethod.java:173)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:86)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy119.xsecxexcel(Unknown Source)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService.xsecx(AccountabilityUnitManageService.java:152)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$FastClassBySpringCGLIB$$49e914cd.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$EnhancerBySpringCGLIB$$bd03b1c.xsecx(<generated>)
	at cn.hbis.erp.modular.system.controller.ExportController.exportXSJSCx(ExportController.java:564)
	at cn.hbis.erp.modular.system.controller.ExportController$$FastClassBySpringCGLIB$$815f3b9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at cn.hbis.erp.core.interceptor.SessionHolderInterceptor.sessionKit(SessionHolderInterceptor.java:29)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.controller.ExportController$$EnhancerBySpringCGLIB$$b64ad9ad.exportXSJSCx(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:189)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:897)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)
	at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)
	at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at cn.stylefeng.roses.core.xss.XssFilter.doFilter(XssFilter.java:31)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:791)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1417)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.sql.SQLException: sql injection violation, comment not allow : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        name,
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        -- nvl(cxname,'-') name,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
	at com.alibaba.druid.wall.WallFilter.checkInternal(WallFilter.java:801)
	at com.alibaba.druid.wall.WallFilter.connection_prepareStatement(WallFilter.java:252)
	at com.alibaba.druid.filter.FilterChainImpl.connection_prepareStatement(FilterChainImpl.java:568)
	at com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl.prepareStatement(ConnectionProxyImpl.java:342)
	at com.alibaba.druid.pool.DruidPooledConnection.prepareStatement(DruidPooledConnection.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy168.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:87)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor.intercept(PaginationInterceptor.java:158)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)
	at com.sun.proxy.$Proxy167.prepare(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:85)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 112 common frames omitted

2019-06-19 18:15:10.051 ERROR 3148 --- [http-nio-8081-exec-6] c.h.erp.core.aop.GlobalExceptionHandler  : 运行时异常:

org.springframework.jdbc.UncategorizedSQLException: 
### Error querying database.  Cause: java.sql.SQLException: sql injection violation, syntax error: TODO : pos 739, line 20, column 33, token COMMA : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        nvl(name,'-') name
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
### The error may exist in file [E:\new\hbis_erp\target\classes\cn\hbis\erp\modular\system\mapper\mapping\AccountabilityUnitManageMapper.xml]
### The error may involve cn.hbis.erp.modular.system.mapper.AccountabilityUnitManageMapper.xsecxexcel
### The error occurred while executing a query
### SQL: SELECT         company_id,         nvl(companyname,'-')companyname,         nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,         nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,         nvl(fkimg,0)fkimg,         nvl(kzwi6,0) kzwi6,         nvl(kzwi6*fkimg,0) money,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         nvl(DESTINATION_NAME,'-')DESTINATION_NAME,         nvl(CONTRACT_NO,0)CONTRACT_NO,         nvl(DJ_DATE,'-')DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         nvl(name,'-') name         nvl(VARIETY,'-')VARIETY,         nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'空') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,         case when cxname is null then  '其他' end name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-') MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-') VGPOS,         nvl(ORDER_NO,'-') ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,          nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from         (SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle          left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso          on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb          ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des          inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('9580','9727','9193')         ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                       and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)           UNION         SELECT         company_id ,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-') name,         vc.VARIETY_CLASS VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,          nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-') PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-')  VBELN,         nvl(VGBEL,'-') VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         xsztdzb.sale_body,         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         sso.DJ_DATE,         settle.VBELN,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.sale_body ss,         sso.SALE_PRICE,         svtp.VARIETY,         (select max(DATA.Name)         from scm_delivery_detail detail         JOIN crm_resource_data DATA         ON DATA.full_name = detail.ext         AND DATA.company_id = detail.company_id         AND (DATA.TYPE = 6 )          where  detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X' or         detail.delivery_delete is null)) cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where detail.ORDER_NO = settle.aubel         and detail.ORDER_ITEM = settle.aupos         and detail.company_id =settle.company_id         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')          and  settle.company_id in ('9196')) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and t.sale_body is not null          UNION         SELECT         company_id,         nvl(companyname,'-')companyname,         fkdat,         fkimg,         nvl(FKART,'-') FKART,         nvl(order_type_describe,'-') order_type_describe,         nvl(product_grade,'-') product_grade,         nvl(sale_group,'-') sale_group,         nvl(sale_body,'-') sale_body,         nvl(ORDER_MOUNT,0) ORDER_MOUNT,         DESTINATION_NAME,         CONTRACT_NO,         DJ_DATE,         nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,         nvl(cxname,'-')  name,         case when  company_id ='1932' then '中厚板'         when  company_id ='8110' then  '圆钢'         when  company_id ='8493' then '薄板' end  VARIETY,         nvl(kzwi6,0) kzwi6,         ACTUAL_DATE,         nvl(product_line,'-') product_line,         nvl(ATTRIBUTE1,'-') ATTRIBUTE1,         nvl(ATTRIBUTE2,'-') ATTRIBUTE2,         nvl(ATTRIBUTE9,'-') ATTRIBUTE9,         nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,         nvl(PAYER_NAME,'-')  PAYER_NAME,         nvl(SALE_PRICE,0) SALE_PRICE,         nvl(VBELN,'-') VBELN,         nvl(VGBEL,'-')  VGBEL,         nvl(VGPOS,'-')  VGPOS,         nvl(ORDER_NO,'-')  ORDER_NO,         nvl(ORDER_ROW,'-') ORDER_ROW,         nvl(DZ_NAME,'-') DZ_NAME,         nvl(PRODUCT_CODE,'-') PRODUCT_CODE,         nvl(ORDER_NOTE,'-') ORDER_NOTE         from (         SELECT distinct         decode(settle.company_id,         9580,         '唐钢',         9727,         '邯钢',         9193,         '宣钢',         9196,         '承钢',         1932,         '舞钢',         8110,         '石钢',         8493,         '衡板',         7778,         '邯宝') AS companyname,         settle.company_id,         case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,         xsztdzb.sale_body，         rpcl.product_grade,         case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,         settle.fkdat,         settle.FKART,         settle.kzwi6,         settle.VBELN,         settle.VGBEL,         settle.VGPOS,         sso.MATERIAL_INFO,         sso.order_mount,         sso.DESTINATION_NAME,         sso.CONTRACT_NO,         sso.order_type_describe,         sso.saler_name,         sso.sale_group,          sso.DJ_DATE,         sso.ATTRIBUTE1,         sso.ATTRIBUTE2,         sso.ATTRIBUTE9,         sso.ORDER_NO,         sso.ORDER_ROW,         sso.ORDER_NOTE,         sso.PRODUCT_TYPE,         sso.PAYER_NAME,         sso.DZ_NAME,         sso.PRODUCT_CODE,         sso.SALE_PRICE,         svtp.VARIETY,         decode(settle.company_id,         1932,         '舞钢中厚板',         8110,         '石钢圆钢',         8493,         '衡板薄板') AS cxname,         (select max(detail.ACTUAL_DATE)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))ACTUAL_DATE,         (select max(detail.ext)         from scm_delivery_detail detail         where settle.company_id = detail.company_id         and settle.vgbel = detail.deliv_numb         and settle.vgpos = detail.deliv_item         and ( detail.delivery_delete  < > 'X'  or         detail.delivery_delete is null))product_line         FROM scm_steel_settle settle         left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso         on settle.company_id = sso.company_id         and settle.aubel = sso.order_no         and settle.aupos = sso.order_row         left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb         ON sso.company_id = xsztdzb.company_id         AND sso.sale_body = xsztdzb.sale_body_des         inner join scm_variety_to_pt_gp svtp         on sso.company_id = svtp.company_id         and sso.product_code = svtp.product_group          left join (SELECT a.company_id,         a.product_class,         a.product_line_class,         a.product_class_crude,         a.product_class_fine,         a.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL a         where a.status = '0'         union all         SELECT b.company_id,         b.second_code,         b.product_line_class,         b.product_class_crude,         b.product_class_fine,         b.product_grade         FROM REPORT_PRODUCT_CLASS_LEVEL b         where b.status = '0') rpcl         on sso.company_id = rpcl.company_id         and sso.product_type = rpcl.product_class         where         settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')         and  settle.company_id in ('8110','8493','1932')          ) t         right JOIN SCM_VARIETY_CLASS vc         on t.cxname = vc.name         where t.order_type_describe not in         (select distinct cfd.data_name         from crm_filter_data cfd                        where cfd.data_type in ('5','10')                                     and cfd.status = '0'         and cfd.company_id = t.company_id)         and t.saler_name not in         (select cfd.data_name         from crm_filter_data cfd         where cfd.data_type = '1'         and cfd.status = '0'         and cfd.company_id = t.company_id         and instr(concat(t.product_line, t.company_id),         concat(cfd.product_line, cfd.company_id))  > 0)         AND t.sale_group NOT IN (SELECT cfd.data_name         FROM crm_filter_data cfd         WHERE cfd.company_id = t.company_id         AND cfd.data_type = 9         AND cfd.status = 0)         and (         t.sggl = '分公司'         or t.sggl = '出口'         or t.sale_group = '销售部'         or  t.sale_group = '营销中心'         or  t.sale_group ='1000'         or  t.sale_group = '科技部'         or  t.sale_group = '舞钢国贸')           )         where 1=1                              ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
### Cause: java.sql.SQLException: sql injection violation, syntax error: TODO : pos 739, line 20, column 33, token COMMA : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        nvl(name,'-') name
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
; uncategorized SQLException; SQL state [null]; error code [0]; sql injection violation, syntax error: TODO : pos 739, line 20, column 33, token COMMA : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        nvl(name,'-') name
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝'); nested exception is java.sql.SQLException: sql injection violation, syntax error: TODO : pos 739, line 20, column 33, token COMMA : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        nvl(name,'-') name
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:89)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.springframework.jdbc.support.AbstractFallbackSQLExceptionTranslator.translate(AbstractFallbackSQLExceptionTranslator.java:81)
	at org.mybatis.spring.MyBatisExceptionTranslator.translateExceptionIfPossible(MyBatisExceptionTranslator.java:73)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:446)
	at com.sun.proxy.$Proxy105.selectList(Unknown Source)
	at org.mybatis.spring.SqlSessionTemplate.selectList(SqlSessionTemplate.java:230)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.executeForMany(PageMapperMethod.java:173)
	at com.baomidou.mybatisplus.core.override.PageMapperMethod.execute(PageMapperMethod.java:86)
	at com.baomidou.mybatisplus.core.override.PageMapperProxy.invoke(PageMapperProxy.java:64)
	at com.sun.proxy.$Proxy119.xsecxexcel(Unknown Source)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService.xsecx(AccountabilityUnitManageService.java:152)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$FastClassBySpringCGLIB$$49e914cd.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at com.alibaba.druid.support.spring.stat.DruidStatInterceptor.invoke(DruidStatInterceptor.java:72)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.service.AccountabilityUnitManageService$$EnhancerBySpringCGLIB$$98a4ad7b.xsecx(<generated>)
	at cn.hbis.erp.modular.system.controller.ExportController.exportXSJSCx(ExportController.java:564)
	at cn.hbis.erp.modular.system.controller.ExportController$$FastClassBySpringCGLIB$$815f3b9.invoke(<generated>)
	at org.springframework.cglib.proxy.MethodProxy.invoke(MethodProxy.java:218)
	at org.springframework.aop.framework.CglibAopProxy$CglibMethodInvocation.invokeJoinpoint(CglibAopProxy.java:749)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.aspectj.MethodInvocationProceedingJoinPoint.proceed(MethodInvocationProceedingJoinPoint.java:88)
	at cn.hbis.erp.core.interceptor.SessionHolderInterceptor.sessionKit(SessionHolderInterceptor.java:29)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethodWithGivenArgs(AbstractAspectJAdvice.java:644)
	at org.springframework.aop.aspectj.AbstractAspectJAdvice.invokeAdviceMethod(AbstractAspectJAdvice.java:633)
	at org.springframework.aop.aspectj.AspectJAroundAdvice.invoke(AspectJAroundAdvice.java:70)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.interceptor.ExposeInvocationInterceptor.invoke(ExposeInvocationInterceptor.java:93)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:186)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:688)
	at cn.hbis.erp.modular.system.controller.ExportController$$EnhancerBySpringCGLIB$$7a349c0b.exportXSJSCx(<generated>)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:189)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:138)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:102)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:895)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:800)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1038)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:942)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1005)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:897)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:634)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:882)
	at javax.servlet.http.HttpServlet.service(HttpServlet.java:741)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:231)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:53)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:61)
	at org.apache.shiro.web.servlet.AdviceFilter.executeChain(AdviceFilter.java:108)
	at org.apache.shiro.web.servlet.AdviceFilter.doFilterInternal(AdviceFilter.java:137)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.shiro.web.servlet.ProxiedFilterChain.doFilter(ProxiedFilterChain.java:66)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.executeChain(AbstractShiroFilter.java:449)
	at org.apache.shiro.web.servlet.AbstractShiroFilter$1.call(AbstractShiroFilter.java:365)
	at org.apache.shiro.subject.support.SubjectCallable.doCall(SubjectCallable.java:90)
	at org.apache.shiro.subject.support.SubjectCallable.call(SubjectCallable.java:83)
	at org.apache.shiro.subject.support.DelegatingSubject.execute(DelegatingSubject.java:387)
	at org.apache.shiro.web.servlet.AbstractShiroFilter.doFilterInternal(AbstractShiroFilter.java:362)
	at org.apache.shiro.web.servlet.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:125)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CorsFilter.doFilterInternal(CorsFilter.java:96)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at cn.stylefeng.roses.core.xss.XssFilter.doFilter(XssFilter.java:31)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at com.alibaba.druid.support.http.WebStatFilter.doFilter(WebStatFilter.java:123)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:99)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:92)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.HiddenHttpMethodFilter.doFilterInternal(HiddenHttpMethodFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:200)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:107)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:166)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:199)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:96)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:490)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:139)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:92)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:74)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:343)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:408)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:66)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:791)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1417)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:49)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:61)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.sql.SQLException: sql injection violation, syntax error: TODO : pos 739, line 20, column 33, token COMMA : SELECT
        company_id,
        nvl(companyname,'-')companyname,
        nvl("TO_CHAR"(FKDAT,'yyyy-mm'),'-') month,
        nvl("TO_CHAR"(fkdat,'yyyy-mm-dd'),'-')fkdat,
        nvl(fkimg,0)fkimg,
        nvl(kzwi6,0) kzwi6,
        nvl(kzwi6*fkimg,0) money,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        nvl(DESTINATION_NAME,'-')DESTINATION_NAME,
        nvl(CONTRACT_NO,0)CONTRACT_NO,
        nvl(DJ_DATE,'-')DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        nvl(name,'-') name
        nvl(VARIETY,'-')VARIETY,
        nvl("TO_CHAR"(ACTUAL_DATE),'-')ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'空') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-') PRODUCT_TYPE,
        case when cxname is null then  '其他' end name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-') MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-') VGPOS,
        nvl(ORDER_NO,'-') ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,

        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from
        (SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle

        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso

        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb

        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des

        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('9580','9727','9193')
        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         







        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)


        UNION
        SELECT
        company_id ,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-') name,
        vc.VARIETY_CLASS VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,

        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-') PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-')  VBELN,
        nvl(VGBEL,'-') VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        xsztdzb.sale_body,
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        sso.DJ_DATE,
        settle.VBELN,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.sale_body ss,
        sso.SALE_PRICE,
        svtp.VARIETY,
        (select max(DATA.Name)
        from scm_delivery_detail detail
        JOIN crm_resource_data DATA
        ON DATA.full_name = detail.ext
        AND DATA.company_id = detail.company_id
        AND (DATA.TYPE = 6 )

        where  detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X' or
        detail.delivery_delete is null)) cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where detail.ORDER_NO = settle.aubel
        and detail.ORDER_ITEM = settle.aupos
        and detail.company_id =settle.company_id
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')

        and  settle.company_id in ('9196')) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and t.sale_body is not null

        UNION
        SELECT
        company_id,
        nvl(companyname,'-')companyname,
        fkdat,
        fkimg,
        nvl(FKART,'-') FKART,
        nvl(order_type_describe,'-') order_type_describe,
        nvl(product_grade,'-') product_grade,
        nvl(sale_group,'-') sale_group,
        nvl(sale_body,'-') sale_body,
        nvl(ORDER_MOUNT,0) ORDER_MOUNT,
        DESTINATION_NAME,
        CONTRACT_NO,
        DJ_DATE,
        nvl(PRODUCT_TYPE,'-')  PRODUCT_TYPE,
        nvl(cxname,'-')  name,
        case when  company_id ='1932' then '中厚板'
        when  company_id ='8110' then  '圆钢'
        when  company_id ='8493' then '薄板' end  VARIETY,
        nvl(kzwi6,0) kzwi6,
        ACTUAL_DATE,
        nvl(product_line,'-') product_line,
        nvl(ATTRIBUTE1,'-') ATTRIBUTE1,
        nvl(ATTRIBUTE2,'-') ATTRIBUTE2,
        nvl(ATTRIBUTE9,'-') ATTRIBUTE9,
        nvl(MATERIAL_INFO,'-')  MATERIAL_INFO,
        nvl(PAYER_NAME,'-')  PAYER_NAME,
        nvl(SALE_PRICE,0) SALE_PRICE,
        nvl(VBELN,'-') VBELN,
        nvl(VGBEL,'-')  VGBEL,
        nvl(VGPOS,'-')  VGPOS,
        nvl(ORDER_NO,'-')  ORDER_NO,
        nvl(ORDER_ROW,'-') ORDER_ROW,
        nvl(DZ_NAME,'-') DZ_NAME,
        nvl(PRODUCT_CODE,'-') PRODUCT_CODE,
        nvl(ORDER_NOTE,'-') ORDER_NOTE
        from (
        SELECT distinct
        decode(settle.company_id,
        9580,
        '唐钢',
        9727,
        '邯钢',
        9193,
        '宣钢',
        9196,
        '承钢',
        1932,
        '舞钢',
        8110,
        '石钢',
        8493,
        '衡板',
        7778,
        '邯宝') AS companyname,
        settle.company_id,
        case when  settle.company_id='8110' then  sso.sale_body  else '' end  sggl,
        xsztdzb.sale_body，
        rpcl.product_grade,
        case when settle.fkimg='0.00' then null else settle.fkimg end fkimg  ,
        settle.fkdat,
        settle.FKART,
        settle.kzwi6,
        settle.VBELN,
        settle.VGBEL,
        settle.VGPOS,
        sso.MATERIAL_INFO,
        sso.order_mount,
        sso.DESTINATION_NAME,
        sso.CONTRACT_NO,
        sso.order_type_describe,
        sso.saler_name,
        sso.sale_group,

        sso.DJ_DATE,
        sso.ATTRIBUTE1,
        sso.ATTRIBUTE2,
        sso.ATTRIBUTE9,
        sso.ORDER_NO,
        sso.ORDER_ROW,
        sso.ORDER_NOTE,
        sso.PRODUCT_TYPE,
        sso.PAYER_NAME,
        sso.DZ_NAME,
        sso.PRODUCT_CODE,
        sso.SALE_PRICE,
        svtp.VARIETY,
        decode(settle.company_id,
        1932,
        '舞钢中厚板',
        8110,
        '石钢圆钢',
        8493,
        '衡板薄板') AS cxname,
        (select max(detail.ACTUAL_DATE)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))ACTUAL_DATE,
        (select max(detail.ext)
        from scm_delivery_detail detail
        where settle.company_id = detail.company_id
        and settle.vgbel = detail.deliv_numb
        and settle.vgpos = detail.deliv_item
        and ( detail.delivery_delete  < > 'X'  or
        detail.delivery_delete is null))product_line
        FROM scm_steel_settle settle
        left join (select * from scm_sale_order where  deleted < > 'X'  or  deleted is  null) sso
        on settle.company_id = sso.company_id
        and settle.aubel = sso.order_no
        and settle.aupos = sso.order_row
        left join (select a.* from price_salebody_relation a where a.is_delete = 0 ) xsztdzb
        ON sso.company_id = xsztdzb.company_id
        AND sso.sale_body = xsztdzb.sale_body_des
        inner join scm_variety_to_pt_gp svtp
        on sso.company_id = svtp.company_id
        and sso.product_code = svtp.product_group

        left join (SELECT a.company_id,
        a.product_class,
        a.product_line_class,
        a.product_class_crude,
        a.product_class_fine,
        a.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL a
        where a.status = '0'
        union all
        SELECT b.company_id,
        b.second_code,
        b.product_line_class,
        b.product_class_crude,
        b.product_class_fine,
        b.product_grade
        FROM REPORT_PRODUCT_CLASS_LEVEL b
        where b.status = '0') rpcl
        on sso.company_id = rpcl.company_id
        and sso.product_type = rpcl.product_class
        where
        settle.fkdat >= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and settle.fkdat <= to_date(?, 'yyyy-mm-dd hh24:mi:ss')
        and  settle.company_id in ('8110','8493','1932')

        ) t
        right JOIN SCM_VARIETY_CLASS vc
        on t.cxname = vc.name
        where t.order_type_describe not in
        (select distinct cfd.data_name
        from crm_filter_data cfd

         
            where cfd.data_type in ('5','10')


         

         





        and cfd.status = '0'
        and cfd.company_id = t.company_id)
        and t.saler_name not in
        (select cfd.data_name
        from crm_filter_data cfd
        where cfd.data_type = '1'
        and cfd.status = '0'
        and cfd.company_id = t.company_id
        and instr(concat(t.product_line, t.company_id),
        concat(cfd.product_line, cfd.company_id))  > 0)
        AND t.sale_group NOT IN (SELECT cfd.data_name
        FROM crm_filter_data cfd
        WHERE cfd.company_id = t.company_id
        AND cfd.data_type = 9
        AND cfd.status = 0)
        and (
        t.sggl = '分公司'
        or t.sggl = '出口'
        or t.sale_group = '销售部'
        or  t.sale_group = '营销中心'
        or  t.sale_group ='1000'
        or  t.sale_group = '科技部'
        or  t.sale_group = '舞钢国贸')


        )
        where 1=1
         
         

        ORDER BY decode(companyname,'唐钢','邯钢','宣钢','承钢','舞钢','石钢','衡板','邯宝')
	at com.alibaba.druid.wall.WallFilter.checkInternal(WallFilter.java:799)
	at com.alibaba.druid.wall.WallFilter.connection_prepareStatement(WallFilter.java:252)
	at com.alibaba.druid.filter.FilterChainImpl.connection_prepareStatement(FilterChainImpl.java:568)
	at com.alibaba.druid.proxy.jdbc.ConnectionProxyImpl.prepareStatement(ConnectionProxyImpl.java:342)
	at com.alibaba.druid.pool.DruidPooledConnection.prepareStatement(DruidPooledConnection.java:349)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.logging.jdbc.ConnectionLogger.invoke(ConnectionLogger.java:55)
	at com.sun.proxy.$Proxy168.prepareStatement(Unknown Source)
	at org.apache.ibatis.executor.statement.PreparedStatementHandler.instantiateStatement(PreparedStatementHandler.java:87)
	at org.apache.ibatis.executor.statement.BaseStatementHandler.prepare(BaseStatementHandler.java:88)
	at org.apache.ibatis.executor.statement.RoutingStatementHandler.prepare(RoutingStatementHandler.java:59)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.ibatis.plugin.Invocation.proceed(Invocation.java:49)
	at com.baomidou.mybatisplus.extension.plugins.PaginationInterceptor.intercept(PaginationInterceptor.java:158)
	at org.apache.ibatis.plugin.Plugin.invoke(Plugin.java:61)
	at com.sun.proxy.$Proxy167.prepare(Unknown Source)
	at org.apache.ibatis.executor.SimpleExecutor.prepareStatement(SimpleExecutor.java:85)
	at org.apache.ibatis.executor.SimpleExecutor.doQuery(SimpleExecutor.java:62)
	at org.apache.ibatis.executor.BaseExecutor.queryFromDatabase(BaseExecutor.java:326)
	at org.apache.ibatis.executor.BaseExecutor.query(BaseExecutor.java:156)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:109)
	at org.apache.ibatis.executor.CachingExecutor.query(CachingExecutor.java:83)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:148)
	at org.apache.ibatis.session.defaults.DefaultSqlSession.selectList(DefaultSqlSession.java:141)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.mybatis.spring.SqlSessionTemplate$SqlSessionInterceptor.invoke(SqlSessionTemplate.java:433)
	... 112 common frames omitted
Caused by: com.alibaba.druid.sql.parser.ParserException: TODO : pos 739, line 20, column 33, token COMMA
	at com.alibaba.druid.sql.dialect.oracle.parser.OracleStatementParser.parseStatementList(OracleStatementParser.java:706)
	at com.alibaba.druid.sql.parser.SQLStatementParser.parseStatementList(SQLStatementParser.java:83)
	at com.alibaba.druid.wall.WallProvider.checkInternal(WallProvider.java:624)
	at com.alibaba.druid.wall.WallProvider.check(WallProvider.java:578)
	at com.alibaba.druid.wall.WallFilter.checkInternal(WallFilter.java:786)
	... 146 common frames omitted

